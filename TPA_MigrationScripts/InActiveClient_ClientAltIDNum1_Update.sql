/*Update IN-ACTIVE Client's # to resolve conflicts between MyPlans and PPC*/

BEGIN TRANSACTION;  
  
BEGIN TRY 
IF((select COUNT(*) from Client_Master_MP mp
join Client_Master pp on pp.altIdNum1 = mp.altIdNum1
where mp.isdead=1) >0 )
BEGIN

DECLARE @InActiveClientList TABLE(ID INT IDENTITY(1,1),AltIDNum1 NVARCHAR(MAX) , UpdatedAltIDNum1 NVARCHAR(MAX))
 
INSERT INTO @InActiveClientList
VALUES 
('0',	'0-99999'),
('1294',	'1294-99999'),
('1651',	'1651-99999'),
('1664',	'1664-99999'),
('1803',	'1803-99999'),
('1832',	'1832-99999'),
('1895',	'1895-99999'),
('1909',	'1909-99999'),
('1930',	'1930-99999'),
('1951',	'1951-99999'),
('1986',	'1986-99999'),
('2130',	'2130-99999'),
('2135',	'2135-99999'),
('2162',	'2162-99999'),
('2175',	'2175-99999'),
('2406',	'2406-99999'),
('2410',	'2410-99999'),
('2425',	'2425-99999'),
('2461',	'2461-99999'),
('2472',	'2472-99999'),
('2490',	'2490-99999'),
('2491',	'2491-99999'),
('2509',	'2509-99999'),
('2533',	'2533-99999'),
('2536',	'2536-99999'),
('2538',	'2538-99999'),
('2551',	'2551-99999'),
('2566',	'2566-99999'),
('2572',	'2572-99999'),
('2583',	'2583-99999'),
('2592',	'2592-99999'),
('2597',	'2597-99999'),
('2610',	'2610-99999'),
('2639',	'2639-99999'),
('2641',	'2641-99999'),
('2669',	'2669-99999'),
('2674',	'2674-99999'),
('2678',	'2678-99999'),
('2693',	'2693-99999'),
('2706',	'2706-99999'),
('2707',	'2707-99999'),
('2719',	'2719-99999'),
('2729',	'2729-99999'),
('2736',	'2736-99999'),
('2738',	'2738-99999'),
('2739',	'2739-99999'),
('2742',	'2742-99999'),
('2747',	'2747-99999'),
('2750',	'2750-99999'),
('2777',	'2777-99999'),
('2779',	'2779-99999'),
('2783',	'2783-99999'),
('2792',	'2792-99999'),
('2794',	'2794-99999'),
('2796',	'2796-99999'),
('2797',	'2797-99999'),
('2800',	'2800-99999'),
('2833',	'2833-99999'),
('2836',	'2836-99999'),
('2842',	'2842-99999'),
('2857',	'2857-99999'),
('2858',	'2858-99999'),
('2864',	'2864-99999'),
('2865',	'2865-99999'),
('2869',	'2869-99999'),
('2891',	'2891-99999'),
('2894',	'2894-99999'),
('2897',	'2897-99999'),
('2915',	'2915-99999'),
('2924',	'2924-99999'),
('9999',	'9999-99999')

UPDATE Client_Master_MP
SET [AltIDNum1]= AC.UpdatedAltIDNum1
FROM Client_Master_MP MP
JOIN @InActiveClientList AC ON MP.AltIDNum1=AC.AltIDNum1

END
END TRY  
BEGIN CATCH  
    IF @@TRANCOUNT > 0  
        ROLLBACK TRANSACTION;
    INSERT INTO dbo.DataMigration_Errors
    VALUES
  (SUSER_SNAME(),
   ERROR_NUMBER(),
   ERROR_STATE(),
   ERROR_SEVERITY(),
   ERROR_LINE(),
   ERROR_PROCEDURE(),
   ERROR_MESSAGE(),
   GETDATE());  
    
END CATCH;  
  
IF @@TRANCOUNT > 0  
    COMMIT TRANSACTION;  
GO  